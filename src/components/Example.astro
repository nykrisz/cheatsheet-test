---
import { Tabs, TabItem } from "@astrojs/starlight/components";
import { Code } from "astro/components";
import { readdir } from "node:fs/promises";
import { readFile } from "node:fs/promises";

const { slug } = Astro.params;

const examples = [];
try {
  const files = await readdir(`./src/content/docs/${slug}/`);
  const filtered = files.filter((file) => file.includes(".js"));

  for (const file of filtered) {
    const content = await readFile(`./src/content/docs/${slug}/${file}`, {
      encoding: "utf8",
    });
    examples.push({ file, content });
  }
} catch (err) {
  console.error(err);
}
---

<Tabs>
  {
    examples.map((example) => {
      return (
        <TabItem label={example.file} icon="star">
          <Code code={example.content} lang="js" />
        </TabItem>
      );
    })
  }
</Tabs>
